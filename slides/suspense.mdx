import { Appear } from "mdx-deck";
import defaultTheme from "mdx-deck/themes";
export { components } from "mdx-deck-code-surfer";

export const theme = {
  ...defaultTheme,
  code: {
    ...defaultTheme.code,
    color: "#000",
    backgroundColor: "rgba(27,31,35,.05)",
    borderRadius: "3px",
    padding: "0 .4em",
    fontSize: "85%"
  }
};

# Modern React

---

## Step 1: React Fiber âœ…

```notes
React Fiber is a complete, backwards compatible rewrite of the React core.
The goal of React Fiber is to increase its suitability for areas like animation, layout, and gestures. Its headline feature is incremental rendering: the ability to split rendering work into chunks and spread it out over multiple frames.
```

1. Error Boundaries
2. Incremental Rendering ðŸ› 
3. Fragments
4. Portals

---

## Step 2: React Suspense âœ…

Defer rendering parts of your component tree.

---

## Step 3: Concurrent React ðŸ› 

Prioritise updates and render multiple updates concurrently.

<Appear>
  <p>This is not ready and cannot be used, at all.</p>
  <p>...but you can prepare your app for it!</p>
</Appear>

---

```javascript Suspense for Code Splitting
const HomeView = React.lazy(() => import('./views/Home'));

const App = () => (
  <Route path="/" component={HomeView} />
);
----
*
1
1,4
```

---

Where is the loading state?

---

```javascript Rendering Fallback Content
const HomeView = React.lazy(() => import('./views/Home'));

const App = () => (
  <React.Suspense fallback={<Spinner />}>
    <Route path="/" component={HomeView} />
  </React.Suspense>
);
----
*
4,6
4,5,6
```

---

## What's next? A look at concurrent React.

---

```javascript React Cache
import { createResource } from 'react-cache';

const GitHubResource = createResource(path => {
  return fetch(`api.github.com${path}`);
})

const RepositoryList = (props) => {
  const user = GitHubResource.read(`/${props.username}`);

  return (
    <>
      {user.repositories
        .map(repo => (/* ... */))}
    </>
  )
}
----
1
1,3
1,3,4,5
1,3,4,5,8
1,3,4,5,8,12,13
```

---

## Loading state?!

---

```javascript Suspense!!
<React.Suspense fallback={<Spinner />}>
  <RepositoryList username="mxstbr" />
</React.Suspense>
```

---

## Hold on a second...

---

## THROWING PROMISES?!?!?!?!?!

---

## How do I prepare for concurrent React?

<Appear>
  <p>Wrap your app in `React.StrictMode` and fix all warnings.</p>
</Appear>

---

## TL;DR

Concurrent React will be ðŸ”¥

Right now we can only use Fiber features and Suspense

---

## Now it's your turn!

Rework `src/App.js` to code-split each route with React Suspense.

**Bonus:** Turn the `RepositoryList` view into a modal that renders on top of the input.
